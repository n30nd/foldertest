[2024-11-05 23:45:51,831][flwr][INFO] - Starting Flower simulation, config: num_rounds=15, no round_timeout
[2024-11-05 23:45:55,763][flwr][INFO] - Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'object_store_memory': 2830469529.0, 'memory': 5660939060.0, 'node:192.168.1.223': 1.0, 'CPU': 12.0}
[2024-11-05 23:45:55,763][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-11-05 23:45:55,763][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 2, 'num_gpus': 0.0}
[2024-11-05 23:45:55,776][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 6 actors
[2024-11-05 23:45:55,777][flwr][INFO] - [INIT]
[2024-11-05 23:45:55,777][flwr][INFO] - Requesting initial parameters from one random client
[2024-11-05 23:45:59,141][flwr][INFO] - Received initial parameters from one random client
[2024-11-05 23:45:59,141][flwr][INFO] - Starting evaluation of initial global parameters
[2024-11-05 23:46:04,444][flwr][INFO] - initial parameters (loss, other metrics): 0.02233906204883869, {'accuracy': 0.375}
[2024-11-05 23:46:04,445][flwr][INFO] - 
[2024-11-05 23:46:04,445][flwr][INFO] - [ROUND 1]
[2024-11-05 23:46:04,445][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 20)
[2024-11-05 23:46:09,460][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars

[2024-11-05 23:46:09,461][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars
[2024-11-05 23:46:10,268][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:46:10,284][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:46:11,060][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars

[2024-11-05 23:46:11,060][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars
[2024-11-05 23:46:11,614][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:46:11,614][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356237, ip=192.168.1.223, actor_id=3b34ba1254aa396da1b16f6e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f1cb41d3ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356237, ip=192.168.1.223, actor_id=3b34ba1254aa396da1b16f6e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f1cb41d3ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:46:11,614][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:46:11,615][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356237, ip=192.168.1.223, actor_id=3b34ba1254aa396da1b16f6e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f1cb41d3ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356237, ip=192.168.1.223, actor_id=3b34ba1254aa396da1b16f6e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f1cb41d3ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:46:11,615][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars

[2024-11-05 23:46:11,616][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars
[2024-11-05 23:46:11,713][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars

[2024-11-05 23:46:11,713][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars
[2024-11-05 23:46:12,140][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:46:12,141][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:46:15,124][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:46:15,124][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:46:17,271][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:46:17,271][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:46:17,272][flwr][INFO] - aggregate_fit: received 0 results and 10 failures
[2024-11-05 23:46:22,362][flwr][INFO] - fit progress: (1, 0.02233906204883869, {'accuracy': 0.375}, 17.91717702599999)
[2024-11-05 23:46:22,362][flwr][INFO] - configure_evaluate: strategy sampled 10 clients (out of 20)
[2024-11-05 23:46:30,753][flwr][INFO] - aggregate_evaluate: received 10 results and 0 failures
[2024-11-05 23:46:30,753][root][INFO] - EVALUATE_METRICS_AGGREGATION: 0.2917378917378918
[2024-11-05 23:46:30,753][flwr][INFO] - 
[2024-11-05 23:46:30,753][flwr][INFO] - [ROUND 2]
[2024-11-05 23:46:30,753][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 20)
[2024-11-05 23:46:34,711][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:46:34,711][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:46:36,314][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:46:36,315][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:46:36,315][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:46:36,315][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:46:36,316][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:46:36,317][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:46:36,317][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:46:36,318][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356237, ip=192.168.1.223, actor_id=3b34ba1254aa396da1b16f6e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f1cb41d3ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356237, ip=192.168.1.223, actor_id=3b34ba1254aa396da1b16f6e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f1cb41d3ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars

[2024-11-05 23:46:36,318][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:46:36,318][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356237, ip=192.168.1.223, actor_id=3b34ba1254aa396da1b16f6e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f1cb41d3ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356237, ip=192.168.1.223, actor_id=3b34ba1254aa396da1b16f6e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f1cb41d3ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars
[2024-11-05 23:46:40,281][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars

[2024-11-05 23:46:40,283][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars
[2024-11-05 23:46:40,889][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:46:40,890][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:46:41,471][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars

[2024-11-05 23:46:41,472][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars
[2024-11-05 23:46:41,993][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:46:41,993][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:46:41,994][flwr][INFO] - aggregate_fit: received 0 results and 10 failures
[2024-11-05 23:46:47,192][flwr][INFO] - fit progress: (2, 0.02233906204883869, {'accuracy': 0.375}, 42.747228547001214)
[2024-11-05 23:46:47,192][flwr][INFO] - configure_evaluate: strategy sampled 10 clients (out of 20)
[2024-11-05 23:46:57,818][flwr][INFO] - aggregate_evaluate: received 10 results and 0 failures
[2024-11-05 23:46:57,818][root][INFO] - EVALUATE_METRICS_AGGREGATION: 0.26481481481481484
[2024-11-05 23:46:57,818][flwr][INFO] - 
[2024-11-05 23:46:57,818][flwr][INFO] - [ROUND 3]
[2024-11-05 23:46:57,819][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 20)
[2024-11-05 23:47:01,720][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:47:01,726][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:47:03,306][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:47:03,306][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars

[2024-11-05 23:47:03,306][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars

[2024-11-05 23:47:03,306][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356237, ip=192.168.1.223, actor_id=3b34ba1254aa396da1b16f6e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f1cb41d3ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356237, ip=192.168.1.223, actor_id=3b34ba1254aa396da1b16f6e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f1cb41d3ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:47:03,307][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:47:03,307][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars
[2024-11-05 23:47:03,307][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars
[2024-11-05 23:47:03,307][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356237, ip=192.168.1.223, actor_id=3b34ba1254aa396da1b16f6e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f1cb41d3ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356237, ip=192.168.1.223, actor_id=3b34ba1254aa396da1b16f6e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f1cb41d3ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:47:03,308][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:47:03,308][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:47:07,300][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars

[2024-11-05 23:47:07,301][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars
[2024-11-05 23:47:07,937][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:47:07,937][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:47:08,435][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:47:08,435][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:47:08,959][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:47:08,960][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:47:08,962][flwr][INFO] - aggregate_fit: received 0 results and 10 failures
[2024-11-05 23:47:14,178][flwr][INFO] - fit progress: (3, 0.02233906204883869, {'accuracy': 0.375}, 69.73312417300076)
[2024-11-05 23:47:14,178][flwr][INFO] - configure_evaluate: strategy sampled 10 clients (out of 20)
[2024-11-05 23:47:25,034][flwr][INFO] - aggregate_evaluate: received 10 results and 0 failures
[2024-11-05 23:47:25,034][root][INFO] - EVALUATE_METRICS_AGGREGATION: 0.28461538461538466
[2024-11-05 23:47:25,034][flwr][INFO] - 
[2024-11-05 23:47:25,034][flwr][INFO] - [ROUND 4]
[2024-11-05 23:47:25,035][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 20)
[2024-11-05 23:47:29,116][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:47:29,117][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:47:30,757][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars

[2024-11-05 23:47:30,757][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:47:30,758][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars
[2024-11-05 23:47:30,758][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:47:30,759][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:47:30,759][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars

[2024-11-05 23:47:30,759][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:47:30,760][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356237, ip=192.168.1.223, actor_id=3b34ba1254aa396da1b16f6e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f1cb41d3ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356237, ip=192.168.1.223, actor_id=3b34ba1254aa396da1b16f6e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f1cb41d3ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:47:30,760][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356239, ip=192.168.1.223, actor_id=0d0f66fee5f15245a9acbf5701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x741ebc2cdcd0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars
[2024-11-05 23:47:30,760][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356237, ip=192.168.1.223, actor_id=3b34ba1254aa396da1b16f6e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f1cb41d3ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356237, ip=192.168.1.223, actor_id=3b34ba1254aa396da1b16f6e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f1cb41d3ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:47:34,770][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:47:34,771][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356238, ip=192.168.1.223, actor_id=c22acd5d11a81ee62436b71501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7b6f34273c70>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:47:35,370][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars

[2024-11-05 23:47:35,370][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356234, ip=192.168.1.223, actor_id=c1db556d030cc9b05b32a7da01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7832e6801ca0>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars
[2024-11-05 23:47:35,863][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'

[2024-11-05 23:47:35,865][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
AttributeError: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356236, ip=192.168.1.223, actor_id=36cca9536a8c57f6aa52870801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d35344cdd00>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in collate_tensor_fn
    numel = sum(x.numel() for x in batch)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 160, in <genexpr>
    numel = sum(x.numel() for x in batch)
AttributeError: 'int' object has no attribute 'numel'
[2024-11-05 23:47:36,440][flwr][ERROR] - Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars

[2024-11-05 23:47:36,440][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/media/namvq/Data/code_flwr/turorial1/client.py", line 71, in fit
    train(self.model, self.trainloader, optim, epochs, self.device, type_fed='FedAvg')
  File "/media/namvq/Data/code_flwr/turorial1/model.py", line 67, in train
    for images, labels in trainloader:
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=356240, ip=192.168.1.223, actor_id=51ae15efba1f80ec7d3e036d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7ea4840cec40>)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 61, in fetch
    return self.collate_fn(data)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 265, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in collate
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 146, in <listcomp>
    return elem_type([collate(samples, collate_fn_map=collate_fn_map) for samples in transposed])
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 120, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/media/namvq/Data/anaconda3/envs/env1/lib/python3.9/site-packages/torch/utils/data/_utils/collate.py", line 184, in collate_int_fn
    return torch.tensor(batch)
ValueError: only one element tensors can be converted to Python scalars
[2024-11-05 23:47:36,441][flwr][INFO] - aggregate_fit: received 0 results and 10 failures
[2024-11-05 23:47:41,681][flwr][INFO] - fit progress: (4, 0.02233906204883869, {'accuracy': 0.375}, 97.23601422200045)
[2024-11-05 23:47:41,681][flwr][INFO] - configure_evaluate: strategy sampled 10 clients (out of 20)
